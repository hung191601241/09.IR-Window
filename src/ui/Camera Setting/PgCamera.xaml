<Page x:Class="VisionInspection.PgCamera"
      xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:se="clr-namespace:VisionInspection"
      xmlns:local="clr-namespace:ITM_Semiconductor" 
      xmlns:local1="clr-namespace:VisionTools.ToolDesign"
      mc:Ignorable="d" 
     d:DesignHeight="1840" d:DesignWidth="1300"
      Title="PgCamera">

    <Page.CommandBindings>
        <CommandBinding Command="New" CanExecute="CommonCommandBinding_CanExecute" />
        <CommandBinding Command="Open" CanExecute="CommonCommandBinding_CanExecute" />
        <CommandBinding Command="Save" CanExecute="CommonCommandBinding_CanExecute" />
    </Page.CommandBindings>
    <Page.Resources>
        <Style x:Key="MenuItemBaseStyle" TargetType="{x:Type ContextMenu}">
            <!--<Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ContextMenu}">
                        <Grid SnapsToDevicePixels="true">
                            <DockPanel>
                                <ContentPresenter x:Name="Icon" ContentSource="Icon" Margin="4,0,6,0" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="Center"/>
                                <Path x:Name="GlyphPanel" Fill="{TemplateBinding Foreground}" FlowDirection="LeftToRight" Margin="7,0,0,0" Visibility="Collapsed" VerticalAlignment="Center"/>
                                <ContentPresenter x:Name="content" ContentSource="Header" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                            </DockPanel>
                            <Popup x:Name="PART_Popup" AllowsTransparency="true" Focusable="false" HorizontalOffset="1" IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}" PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}" Placement="Bottom" VerticalOffset="-1">

                                <Border BorderThickness="2" BorderBrush="#202020" Background="#202020">
                                    <ScrollViewer x:Name="SubMenuScrollViewer" CanContentScroll="true" Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly={x:Type FrameworkElement}}}">
                                        <Grid RenderOptions.ClearTypeHint="Enabled">
                                            <ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Cycle" Grid.IsSharedSizeScope="true" Margin="2" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" KeyboardNavigation.TabNavigation="Cycle"/>
                                        </Grid>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="TextBlock.Foreground" Value="DarkOrange" TargetName="content"/>

                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>-->
            <Setter Property="Foreground" Value="LightGray"></Setter>
        </Style>
        <Style TargetType="MenuItem">
            <Setter Property="Foreground" Value="LightGray" />
            <Setter Property="Background" Value="#404040"></Setter>
            <Style.Triggers>
                <Trigger Property = "IsMouseOver" Value = "True">

                </Trigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="ComboBox">
            <Setter Property="FontSize" Value="15"></Setter>
            <Setter Property="Background" Value="#222222"></Setter>
            <Setter Property="Foreground" Value="#222222"></Setter>
            <Setter Property="SelectedValue" Value="Content"></Setter>
            <Setter Property="IsEditable" Value="True"></Setter>
        </Style>
        <Style TargetType="TextBox">
            <Setter Property="Background" Value="#555555"></Setter>
            <Setter Property="Foreground" Value="LightGray"></Setter>
        </Style>
        <Style TargetType="Label">
            <Setter Property="Foreground" Value="White"></Setter>
        </Style>
        <Style TargetType="xctk:IntegerUpDown">
            <Setter Property="Foreground" Value="White"></Setter>
            <Setter Property="Background" Value="#454343"></Setter>
        </Style>
    </Page.Resources>

    <Grid Background="#333333">
        <Grid.RowDefinitions>
            <RowDefinition Height="90*"></RowDefinition>
            <RowDefinition Height="10*"></RowDefinition>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="70*"></ColumnDefinition>
                <ColumnDefinition Width="3"></ColumnDefinition>
                <ColumnDefinition Width="30*"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Grid Grid.Column="0">

                <Grid.RowDefinitions>
                    <RowDefinition Height="5*"></RowDefinition>
                    <RowDefinition Height="5*"></RowDefinition>
                    <RowDefinition Height="80*"></RowDefinition>
                </Grid.RowDefinitions>
                <Label Name="lbl_Status_Camera" Grid.Row="0" VerticalAlignment="Center"  HorizontalAlignment="Left"
                           Foreground="#FF13ABE9"
                           FontSize="20" FontWeight="Bold">Both Chanel is Close</Label>
                <!--<Label   Content="Image Source" Foreground="#FF07A9F0"></Label>-->
                <Grid Grid.Row="1">
                    <Grid.Resources>
                        <Style TargetType="{x:Type Button}">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type Button}">
                                        <Border Background="{TemplateBinding Background}" BorderBrush="Black" BorderThickness="0">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#444444"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Grid.Resources>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="317*"/>
                        <ColumnDefinition Width="597*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Background="#555555" Grid.ColumnSpan="2">
                        <Button Height="20" Width="20" Margin="0,0,5,0" >
                            <Image x:Name="cameraGrab">
                                <Image.ToolTip>
                                    <ToolTip Background="LightYellow">
                                        <TextBlock TextWrapping="WrapWithOverflow">Start Acquisition.</TextBlock>
                                    </ToolTip>
                                </Image.ToolTip>
                            </Image>
                        </Button>
                        <Button Name="btnCamCenterLine" Height="20" Width="20" Margin="0,0,5,0">
                            <Image Name="cameraCenterLine">
                                <Image.ToolTip>
                                    <ToolTip Background="LightYellow">
                                        <TextBlock TextWrapping="WrapWithOverflow">Show Cross Line</TextBlock>
                                    </ToolTip>
                                </Image.ToolTip>
                            </Image>
                        </Button>
                        <Button Height="20" Width="20" Margin="0,0,5,0">
                            <Image Name="cameraGridLine">
                                <Image.ToolTip>
                                    <ToolTip Background="LightYellow">
                                        <TextBlock TextWrapping="WrapWithOverflow">Show Grid</TextBlock>
                                    </ToolTip>
                                </Image.ToolTip>
                            </Image>
                        </Button>
                        <Button Name="btnCameraZoomIn" Height="20" Width="20" Margin="0,0,5,0">
                            <Image Name="cameraZoomIn">
                                <Image.ToolTip>
                                    <ToolTip Background="LightYellow">
                                        <TextBlock TextWrapping="WrapWithOverflow">Zoom in</TextBlock>
                                    </ToolTip>
                                </Image.ToolTip>
                            </Image>
                        </Button>
                        <Button Name="btnCameraZoomOut" Height="20" Width="20" Margin="0,0,5,0">
                            <Image Name="cameraZoomOut">
                                <Image.ToolTip>
                                    <ToolTip Background="LightYellow">
                                        <TextBlock TextWrapping="WrapWithOverflow">Zoom out</TextBlock>
                                    </ToolTip>
                                </Image.ToolTip>
                            </Image>
                        </Button>
                        <Button x:Name="btnCreatRoi" Height="20" Width="20" Margin="0,0,5,0">
                            <Image Name="cameraFrameSave">
                                <Image.ToolTip>
                                    <ToolTip Background="LightYellow">
                                        <TextBlock TextWrapping="WrapWithOverflow">
            Add new Region. <LineBreak />
                                        </TextBlock>
                                    </ToolTip>
                                </Image.ToolTip>
                            </Image>
                        </Button>
                        <ComboBox x:Name="cbxDisplayResult" IsEditable="False" x:FieldModifier="public" Margin="20,0,5,0" Height="30" Width="500" FontSize="15"/>
                    </StackPanel>
                </Grid>
                <Grid Grid.Row="2" Name="grCanvas">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="10*"></RowDefinition>
                        <RowDefinition Height="1*"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid x:Name="myGrid" Grid.Row="0">
                        <ScrollViewer x:Name="scrVw_Image" CanContentScroll="True" HorizontalScrollBarVisibility="Auto"  VerticalScrollBarVisibility="Visible">
                            <Canvas Panel.ZIndex="1" Name="myCanvas" ClipToBounds="True"
            RenderTransformOrigin="0,0" MouseLeftButtonDown="MainCanvas_MouseLeftButtonDown" MouseLeftButtonUp="MainCanvas_MouseLeftButtonUp" MouseMove="MainCanvas_MouseMove" MouseWheel="Container_MouseWheel" MouseRightButtonDown="MainCanvas_MouseRightButtonDown">
                                <Image Source="/src/ui/Images/OK.bmp" HorizontalAlignment="Left" Width="{Binding ElementName=myCanvas, Path=ActualWidth, Mode=OneWay}" Height="{Binding ElementName=myCanvas, Path=ActualHeight, Mode=OneWay}"  Name="imgView">
                                </Image>
                                <Line MouseLeftButtonDown="MainCanvas_MouseLeftButtonDown" MouseLeftButtonUp="MainCanvas_MouseLeftButtonUp" MouseMove="MainCanvas_MouseMove" Visibility="Hidden" Name="LineCreossY" Panel.ZIndex="1"
X1="600" Y1="60"
X2="600" Y2="800"
Stroke="OrangeRed"
StrokeThickness="3" />
                                <Line MouseLeftButtonDown="MainCanvas_MouseLeftButtonDown" MouseLeftButtonUp="MainCanvas_MouseLeftButtonUp" MouseMove="MainCanvas_MouseMove" Visibility="Hidden" Name="LineCreossX" Panel.ZIndex="1"
X1="0" Y1="500"
X2="1000" Y2="500"
Stroke="OrangeRed"
StrokeThickness="3" />
                                <TextBox FontSize="20" x:Name="myToolTip" ToolTipService.InitialShowDelay="5000" 
            ToolTipService.ShowDuration="2000" 
            ToolTipService.BetweenShowDelay="10000" 
            ToolTip="This is a tool tip." Panel.ZIndex="100" />
                                <!--<se:ShapeEditor x:Name="ShapeEditorControl" Height="100" Canvas.Left="46" Canvas.Top="170" Width="100"/>-->
                            </Canvas>
                        </ScrollViewer>
                    </Grid>
                    <StackPanel Grid.Row="1" Orientation="Horizontal">
                        <Label Name="CanImageRGB" Margin="0,0,10,0" Width="150">R: 122, G: 122, B: 122</Label>
                        <Label Width="200" Name="canVasPos" Margin="0,0,10,0">Position: 1123, 657</Label>
                        <Label Name="CanResolution" Margin="0,0,10,0">Image: 5432 x 3247</Label>
                    </StackPanel>
                </Grid>
            </Grid>
            <Grid Grid.Column="2">
                <Grid.Resources>
                    <Style x:Key="MenuItemBaseStyle" TargetType="{x:Type MenuItem}">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type MenuItem}">
                                    <Grid SnapsToDevicePixels="true">
                                        <DockPanel>
                                            <ContentPresenter x:Name="Icon" ContentSource="Icon" Margin="4,0,6,0" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="Center"/>
                                            <Path x:Name="GlyphPanel" Fill="{TemplateBinding Foreground}" FlowDirection="LeftToRight" Margin="7,0,0,0" Visibility="Collapsed" VerticalAlignment="Center"/>
                                            <ContentPresenter x:Name="content" ContentSource="Header" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                        </DockPanel>
                                        <Popup x:Name="PART_Popup" AllowsTransparency="true" Focusable="false" HorizontalOffset="1" IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}" PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}" Placement="Bottom" VerticalOffset="-1">

                                            <Border BorderThickness="2" BorderBrush="#202020" Background="#202020">
                                                <ScrollViewer x:Name="SubMenuScrollViewer" CanContentScroll="true" Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly={x:Type FrameworkElement}}}">
                                                    <Grid RenderOptions.ClearTypeHint="Enabled">
                                                        <ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Cycle" Grid.IsSharedSizeScope="true" Margin="2" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" KeyboardNavigation.TabNavigation="Cycle"/>
                                                    </Grid>
                                                </ScrollViewer>
                                            </Border>
                                        </Popup>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="TextBlock.Foreground" Value="DarkOrange" TargetName="content"/>

                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Setter Property="Foreground" Value="LightGray"></Setter>
                    </Style>
                    <Style TargetType="MenuItem">
                        <Setter Property="Foreground" Value="LightGray" />
                        <Setter Property="Background" Value="#404040"></Setter>
                        <Style.Triggers>
                            <Trigger Property = "IsMouseOver" Value = "True">

                            </Trigger>
                        </Style.Triggers>
                    </Style>
                    <Style TargetType="ComboBox">
                        <Setter Property="FontSize" Value="15"></Setter>
                        <Setter Property="Background" Value="#222222"></Setter>
                        <Setter Property="Foreground" Value="#222222"></Setter>
                        <Setter Property="SelectedValue" Value="Content"></Setter>
                        <Setter Property="IsEditable" Value="True"></Setter>
                    </Style>
                    <Style TargetType="TextBox">
                        <Setter Property="Background" Value="#555555"></Setter>
                        <Setter Property="Foreground" Value="LightGray"></Setter>
                    </Style>
                    <Style TargetType="Label">
                        <Setter Property="Foreground" Value="White"></Setter>
                    </Style>
                    <Style TargetType="xctk:IntegerUpDown">
                        <Setter Property="Foreground" Value="White"></Setter>
                        <Setter Property="Background" Value="#454343"></Setter>
                    </Style>
                    <Style TargetType="Button">
                        <Setter Property="Foreground" Value="Black"></Setter>
                        <Setter Property="Background" Value="#777777"></Setter>
                    </Style>
                </Grid.Resources>
                <Grid.RowDefinitions>
                    <RowDefinition Height="5*"></RowDefinition>
                    <RowDefinition Height="5*"></RowDefinition>
                    <RowDefinition Height="80*"></RowDefinition>
                </Grid.RowDefinitions>

                <Menu Grid.Row="1" Background="#404040">
                    <MenuItem x:Name="btnOpenPylon" Header="Camera View" Style="{StaticResource MenuItemBaseStyle}">
                        <MenuItem x:Name="menuPylonView" Header="Basler Camera App" >
                            <MenuItem.Icon>
                                <Image Source="/src/ui/Images/pylon.jpg"></Image>
                            </MenuItem.Icon>
                        </MenuItem>
                        <!--<Separator/>-->
                        <MenuItem x:Name="menuMVSView" Header="Hik Camera App">
                            <MenuItem.Icon>
                                <Image Source="/src/ui/Images/MVS.jpg"></Image>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem x:Name="menuRedo" Header="Redo"/>
                        <!--<Separator/>-->
                        <MenuItem x:Name="menuCanvasBackground" Header="Background">
                            <MenuItem x:Name="menuBackground" Header="Color"/>
                            <MenuItem x:Name="menuBackgroundImage" Header="Image"/>
                        </MenuItem>
                    </MenuItem>
                    <MenuItem x:Name="menuSaveAs" Header="Parameter Setting" Style="{StaticResource MenuItemBaseStyle}" >
                        <MenuItem x:Name="menuHikCamView" Header="View - Setting">
                            <MenuItem.Icon>
                                <Image Source="/src/ui/Images/menu-mechanic.png"></Image>
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                    <MenuItem x:Name="menuExport" Header="Export" Style="{StaticResource MenuItemBaseStyle}"/>
                    <MenuItem x:Name="menuView" Header="View" Style="{StaticResource MenuItemBaseStyle}"/>
                    <MenuItem x:Name="menuQuit" Header="Help" Style="{StaticResource MenuItemBaseStyle}"/>
                </Menu>
                <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button x:Name="btnCamSaveSetting" Background="#555555"  Margin="5,5,5,5">
                        <StackPanel Orientation="Horizontal">
                            <Image x:Name="img" Height="16" Width="16" Source="/src/ui/Images/save.png" ></Image>
                            <Label Foreground="White" Content="Save All"></Label>
                        </StackPanel>
                    </Button>
                    <Button Background="#555555" Margin="5,5,5,5">
                        <StackPanel Orientation="Horizontal">
                            <Image Height="16" Width="16" Source="/src/ui/Images/reset.png" ></Image>
                            <Label Foreground="White" Content="Default"></Label>
                        </StackPanel>
                    </Button>
                </StackPanel>
                <Grid Grid.Row="2">
                    <Grid.Resources>
                        <Style TargetType="TreeViewItem">
                            <Setter Property="Foreground" Value="White" />
                        </Style>
                    </Grid.Resources>
                    <TabControl Background="#505050">
                        <TabItem x:Name="tabVisionTool">
                            <TabItem.Header>
                                <TextBlock Text="Vision Tools Setting" Background="Transparent"/>
                            </TabItem.Header>
                            <TabItem.Resources>
                                <ContextMenu x:Key="cmVP">
                                    <MenuItem Background="Transparent" Foreground="Black" Header="Tool List" Click="MnItOpenToolList_Click">
                                        <MenuItem.Icon>
                                            <Image></Image>
                                        </MenuItem.Icon>
                                    </MenuItem>
                                    <MenuItem Background="Transparent" Foreground="Black" Header="Add New Vision Program" Click="MnItAddNewVP_Click">
                                        <MenuItem.Icon>
                                            <Image></Image>
                                        </MenuItem.Icon>
                                    </MenuItem>
                                    <MenuItem Background="Transparent" Foreground="Black" Header="Rename Vision Program" Click="MnItRenameVP_Click">
                                        <MenuItem.Icon>
                                            <Image></Image>
                                        </MenuItem.Icon>
                                    </MenuItem>
                                </ContextMenu>
                                <ContextMenu x:Key="cmMainVP">
                                    <MenuItem Background="Transparent" Foreground="Black" Header="Rename" Click="MnItRename_Click">
                                        <MenuItem.Icon>
                                            <Image></Image>
                                        </MenuItem.Icon>
                                    </MenuItem>
                                    <MenuItem Background="Transparent" Foreground="Black" Header="Add New Sub Program" Click="MnItAddNewSub_Click">
                                        <MenuItem.Icon>
                                            <Image></Image>
                                        </MenuItem.Icon>
                                    </MenuItem>
                                    <MenuItem Background="Transparent" Foreground="Black" Header="Delete Vision Program" Click="MnItDeleteVP_Click">
                                        <MenuItem.Icon>
                                            <Image></Image>
                                        </MenuItem.Icon>
                                    </MenuItem>
                                </ContextMenu>
                                <ContextMenu x:Key="cmSub">
                                    <MenuItem Background="Transparent" Foreground="Black" Header="Rename Sub Program" Click="MnItRenameSubVP_Click">
                                        <MenuItem.Icon>
                                            <Image></Image>
                                        </MenuItem.Icon>
                                    </MenuItem>
                                    <MenuItem Background="Transparent" Foreground="Black" Header="Delete Sub Program" Click="MnItDeleteSubVP_Click">
                                        <MenuItem.Icon>
                                            <Image></Image>
                                        </MenuItem.Icon>
                                    </MenuItem>
                                </ContextMenu>
                            </TabItem.Resources>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <ScrollViewer CanContentScroll="False" HorizontalScrollBarVisibility="Auto">
                                    <StackPanel x:Name="stVisionProgram">
                                        <StackPanel.Resources>
                                            <Style TargetType="{x:Type Label}">
                                                <Setter Property="Foreground" Value="White"/>
                                                <Setter Property="FontSize" Value="15"/>
                                                <Setter Property="VerticalContentAlignment" Value="Center"/>
                                                <Style.Triggers>
                                                    <!-- Khi chuột di vào -->
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="LightGray"/>
                                                        <Setter Property="Foreground" Value="CornflowerBlue"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                            <Style TargetType="{x:Type TextBox}">
                                                <Setter Property="FontSize" Value="15"/>
                                                <Setter Property="Background" Value="#555555"/>
                                                <Setter Property="Foreground" Value="White"/>
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                                <Setter Property="TextAlignment" Value="Left"/>
                                                <Setter Property="Padding" Value="0,3,0,3"/>
                                            </Style>
                                            <Style TargetType="{x:Type ComboBox}">
                                                <Setter Property="FontSize" Value="15"/>
                                                <Setter Property="Width" Value="100"/>
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="IsEditable" Value="False"/>
                                            </Style>
                                        </StackPanel.Resources>
                                        <Border BorderBrush="#CCCCCC" BorderThickness="0.5">
                                            <DockPanel Height="30" HorizontalAlignment="Stretch">
                                                <Label Content="Setup Communication" FontSize="16" Padding="5,3" VerticalAlignment="Top" FontWeight="Bold"/>
                                                <Button x:Name="btnEditCom" HorizontalAlignment="Right" Background="#FF8A94A8" Click="BtnEditCom_Click">
                                                    <StackPanel Width="110" Orientation="Horizontal">
                                                        <Image Source="/src/ui/Images/EditCom.png" Width="25"/>
                                                        <Label Content="Comm Edit" Padding="3,0,0,0" FontWeight="Bold"/>
                                                    </StackPanel>
                                                </Button>
                                            </DockPanel>
                                        </Border>
                                        <Border BorderBrush="#CCCCCC" BorderThickness="0.5">
                                            <DockPanel Height="30" HorizontalAlignment="Stretch">
                                                <Label x:Name="lbVisionProgram" Content="Vision Program" FontSize="16" FontWeight="Bold" Foreground="White" Padding="5,3"/>
                                                <ComboBox x:Name="cbxJob" IsEnabled="True" SelectedValue="Job1" SelectedValuePath="Content" x:FieldModifier="public" Width="80" HorizontalAlignment="Right" IsEditable="False" FontWeight="Bold" Margin="50,0,0,0" Padding="10,5,0,0">
                                                    <ComboBoxItem FontSize="15">Job1</ComboBoxItem>
                                                    <ComboBoxItem FontSize="15">Job2</ComboBoxItem>
                                                    <ComboBoxItem FontSize="15">Job3</ComboBoxItem>
                                                    <ComboBoxItem FontSize="15">Job4</ComboBoxItem>
                                                    <ComboBoxItem FontSize="15">Job5</ComboBoxItem>
                                                </ComboBox>
                                            </DockPanel>
                                        </Border>

                                        <Expander Background="#404040" >
                                            <Expander.Header>
                                                <DockPanel LastChildFill="True" Height="30">
                                                    <Button Margin="0,0,5,0">
                                                        <Image Source="/src/ui/Images/RunRed.png"/>
                                                    </Button>
                                                    <Label Content="Vision Program 1" FontWeight="Bold" Padding="5,3,0,0"/>
                                                </DockPanel>
                                            </Expander.Header>
                                            <StackPanel Margin="15,0,0,0">
                                                <Expander>
                                                    <Expander.Header >
                                                        <Label Content="Input Trigger" Padding="0,3,0,0" Height="30"/>
                                                    </Expander.Header>
                                                    <StackPanel Orientation="Horizontal" Background="#CCCCCC" Margin="25,0,15,0" HorizontalAlignment="Left" Width="287">
                                                        <Label Width="70" Foreground="Black">Trigger :</Label>
                                                        <ComboBox x:Name="cbxDevIn" Width="60" Margin="0,5,0,5" ItemsSource="{Binding DeviceCodes}" SelectedItem="{Binding SelectDevIn, Mode=TwoWay}"/>
                                                        <TextBox x:Name="txtAddrIn" Margin="0,5,0,5" Width="120"/>
                                                    </StackPanel>
                                                </Expander>
                                                <Expander>
                                                    <Expander.Header >
                                                        <DockPanel Height="30">
                                                            <Button>
                                                                <Image Source="/src/ui/Images/RunToolButton.png"/>
                                                            </Button>
                                                            <Label Content="Main Program" Padding="5,3,0,0"/>
                                                        </DockPanel>
                                                    </Expander.Header>
                                                    <ScrollViewer Height="400" Margin="0,5,0,0" CanContentScroll="True">
                                                        <Canvas x:Name="canvasToolArea" Background="White" Margin="0" AllowDrop="True" x:FieldModifier="public"/>
                                                    </ScrollViewer>
                                                </Expander>
                                                <Expander Margin="0">
                                                    <Expander.Header>
                                                        <DockPanel Height="30" HorizontalAlignment="Stretch">
                                                            <Button>
                                                                <Image Source="/src/ui/Images/RunToolButton.png"/>
                                                            </Button>
                                                            <Label Content="Sub Program 1" Padding="5,3,0,0"/>
                                                        </DockPanel>
                                                    </Expander.Header>
                                                    <ScrollViewer Height="500" HorizontalAlignment="Stretch" Margin="0,5,0,0" CanContentScroll="True">
                                                        <Canvas Background="White" Margin="0" AllowDrop="True"/>
                                                    </ScrollViewer>
                                                </Expander>
                                            </StackPanel>
                                            
                                        </Expander>


                                    </StackPanel>
                                </ScrollViewer>
                                <!--<local1:ToolList Grid.Column="1" OnToolListClosed="ToolList_OnToolListClosed"/>-->
                            </Grid>

                        </TabItem>
                    </TabControl>
                </Grid>
            </Grid>
            <!-- Thanh kéo chia cột -->
            <GridSplitter x:Name="gridSplit" Grid.Column="1"
                      Background="DarkGray"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch"
                      ResizeBehavior="PreviousAndNext"
                      ShowsPreview="True"/>
        </Grid>
        <Grid Grid.Row="1">
            <Grid.Resources>
                <Style TargetType="Button" BasedOn="{StaticResource mButton}">
                    <Setter Property="FontSize" Value="24" />
                    <Setter Property="FontWeight" Value="Bold" />
                    <Setter Property="Margin" Value="10,10,10,10" />
                </Style>
                <Style TargetType="ItemsControl" x:Key="LogViewerStyle">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate>
                                <ScrollViewer CanContentScroll="True">
                                    <ItemsPresenter/>
                                </ScrollViewer>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="ItemsPanel">
                        <Setter.Value>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel IsItemsHost="True"/>
                            </ItemsPanelTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Grid.Resources>
            <DockPanel Background="Black">
                <ItemsControl ItemsSource="{Binding LogEntries}" Style="{StaticResource LogViewerStyle}" RenderTransformOrigin="0.5,0.5">
                    <ItemsControl.RenderTransform>
                        <TransformGroup>
                            <ScaleTransform/>
                            <SkewTransform/>
                            <RotateTransform Angle="1.253"/>
                            <TranslateTransform/>
                        </TransformGroup>
                    </ItemsControl.RenderTransform>
                    <ItemsControl.Template>
                        <ControlTemplate>
                            <ScrollViewer CanContentScroll="True" ScrollChanged="ScrollViewer_ScrollChanged">
                                <ItemsPresenter/>
                            </ScrollViewer>
                        </ControlTemplate>
                    </ItemsControl.Template>
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel IsItemsHost="True"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </DockPanel>
        </Grid>

    </Grid>
</Page>
